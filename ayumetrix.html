<!doctype html>
<html lang="en">
    <head>
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-150539018-2"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'UA-150539018-2');
        </script>
        <meta charset="utf-8">
        <title>Base | Checkout | get-base.com | At-home tests for Sleep/Stress/Energy/Diet</title>
        <meta name="description" content="Know Your Body by looking into your blood data. Experiment and Learn" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="css/socicon.css" rel="stylesheet" type="text/css" media="all" />
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link href="css/iconsmind.css" rel="stylesheet" type="text/css" media="all" />
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <link href="css/stack-interface.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/theme-cedar.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/custom.css" rel="stylesheet" type="text/css" media="all" />
        <link href="https://fonts.googleapis.com/css?family=DM+Sans:500,700&display=swap" rel="stylesheet">
        <link href="css/font-DM-Sans.css" rel="stylesheet" type="text/css">
        <link rel="icon" href="img/squared_logo_tiny.png">

        <script>
            !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"];analytics.factory=function(e){return function(){var t=Array.prototype.slice.call(arguments);t.unshift(e);analytics.push(t);return analytics}};for(var e=0;e<analytics.methods.length;e++){var t=analytics.methods[e];analytics[t]=analytics.factory(t)}analytics.load=function(e,t){var n=document.createElement("script");n.type="text/javascript";n.async=!0;n.src="https://cdn.segment.com/analytics.js/v1/"+e+"/analytics.min.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(n,a);analytics._loadOptions=t};analytics.SNIPPET_VERSION="4.1.0";
          analytics.load("3degDpmcg046CYaZmpXTVIsDcIDgqdbc");
          analytics.page();
          }}();
        </script>

    </head>
    <body data-smooth-scroll-offset="77">
        <div class="fade-loading" style="display: none;"></div>
        <div class="pb-2 text-center spinner spinner-grow" role="status" id="stripeSpinner" style="display: none;">
            <span class="sr-only">Loading...</span>
        </div>
        <nav class="navbar sticky-top navbar-expand-md navbar-light bg-white">
            <a class="navbar-brand logo-nav" href="index.html"> <span class="nav-logo logo" alt="logo"> <img src="img/LOGO.png" class="logo-img"> </span></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse align-middle" id="navbarSupportedContent">
                <ul class="navbar-nav mr-auto">
                    <li></li><li></li>
                </ul>
                <div class="navbar-nav">
                    <div class="row">
                        <ul class="navbar-nav mr-auto align-middle">

                        </ul>

                    </div>
                </div>
            </div>
        </nav>
        <div class="main-container">

            <div class="main-container">
                <section class="imagebg text-center" style="padding-bottom: 40px !important;">
                    <div class="background-image-holder">
                        <img id="gradient-holder" src="img/hero_gradient_v2.jpg">
                    </div>
                    <div class="container">
                        <div class="row mb-3">
                            <div class="col-sm-9 col-md-8">
                                <span class="base-24-tag color-black">AYUMETRIX PORTAL</span>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="text-center" style="padding-bottom: 0px !important;">
                    <div class="container">
                        <div class="row">
                            <div class="col-sm-9">
                                <div class="black-box pl-4 pt-4 mb-4 pr-4 bg-white">
                                    <div class="color-black base-18-items mb-4">1. LAB ACCOUNT DETAILS</div><br>
                                    <div id="login-form" class="row ml-1">
                                        <form class="text-center pt-3" style="width: 90%;" id="form-subscribe">
                                            <div class="form-group mb-2">
                                                <input class="form-control email-signin base-16" required type="text" id="userEmail" placeholder="Email Address">
                                            </div>
                                            <div class="form-group mb15">
                                                <input required type="password" autocomplete="current-password" class="form-control email-signin base-16" id="passwordSubs" placeholder="Password">
                                            </div>
                                            <div class="form-group" style="width: 100%;">
                                                <button
                                                        type="submit"
                                                        class="base-21 black-box-filled color--white"
                                                        style="padding: 0.5em 0.2em 0.5em 0.2em !important; width: 100%;"
                                                        id="checkout-button-plan_GKFWN8kzGvEGFD"
                                                        role="link"
                                                        onclick="gtag('event', 'account', {'event_category' : 'checkout', 'event_label' : 'login'});">
                                                    Log In<img class="button-arrow"src="img/base_arrow_white.svg">
                                                </button>
                                            </div>
                                            <div id="error-message"></div>
                                        </form>
                                    </div>
                                    <div class="row" id="account-details">
                                        <div class="col-8">
                                            <span id="account-email" class="color-black base-16 pb30"></span>
                                        </div>
                                        <div class=" col-4 text-right">
                                            <span class="base-14 color-black"><a style="text-decoration: underline;" href="#" id="sign-out">sign out</a></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                   
                </section>
                
                <div class="container">
                    <div class="row">
                            <div class="col-sm-8">
                                <div class="spinner-grow" style="display: none;" role="status" id="codeSpinner">
                                    <span class="sr-only">Loading...</span>
                                </div>
                                <p class="color--primary base-16" id="code-resp"></p>
                        </div>
                    </div>
                </div>

                <section class="text-center" style="padding-top: 0px !important;" id="kit-scan">
                    <div class="container">
                        <div class="row">
                            <div class="col-sm-8">
                                <h2 class="crystal-title color-dark-green" id="choice-response"></h2>
                            </div>
                        </div> 
                        <div class="row">
                            <div class="col-sm-12">
                                <p><span class="base-21 color-black">Scan or Insert Bar Code</span></p>
                                <form class="form-inline" autocomplete="off" style="display: inline;">
                                    <input type="text" class="zipcode-box pl-3" id="ipcode-search" placeholder="___-___-___" autocomplete="off">
                                    <a class="btn black-box" style="min-width: 100px;" id="zipcode-button">Search</a>
                                </form>
                                <p><a href="#" id="lab-choice" class="mt30 base-21 pb-3 pt-3 btn btn--green color--white"
                                      onclick="gtag('event', 'checkout', {'event_category' : 'test_choice', 'event_label' : 'lab'});">Download CSV <img src="img/base_arrow_white_sm.svg" class="button-arrow"> </a></p>
                                <p class="crystal-text" style="display: none; color: #df002c;" id="error-zipcode-search"></p>
                                <h4 style="display: none;" id="lab-covid" class="mb64 color-black base-21">Due to Covid-19, we encourage you to take your test at-home. We can schedule a video chat to coach you on how to do a finger-prick!</h4>
                                <div class="feature find---us boxed boxed--border" id="ny-lab-locations" style="display: none;">
                                    <span class="h5 color--primary-1">No appointment needed</span>
                                    <h2 class="large uppercase mb64 crystal-subheader color--primary-1"><b>Locations</b></h2>
                                </div>

                            </div>
                        </div>
                        <div class="row text-center mt30">
                            <div class="col-sm-8">
                                <table id="my-table" class="table">
                                    <tbody>
                                        <thead>
                                             <tr>
                                                <th scope="col">Kit ID #</th>
                                             </tr>
                                        </thead>
                                        <tr></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="row text-center mt30">
                            <div class="col-sm-8">
                                <p><span class="base-18-body color-black">Not sure how you’d like to proceed? Shoot us a message for more info.</p>
                                <p><span class="base-16 color-black">If you have any questions, contact Customer Support or email <a href="mailto:info@get-base.com">members@get-base.com</a>. </span></p>
                            </div>
                        </div>

                    </div>
                </section>


                <footer class="text-center-xs space--xs bg--white">
                    <div class="container">
                        <div class="row">
                            <div class="col-sm-7">
                                <ul class="list-inline color--black">
                                    <li> <a href="privacy-policy" target="_blank"><span class="color-black base-18-items">Privacy Policy</span></a> </li>
                                    <li> <a href="terms" target="_blank"><span class="color-black base-18-items">Terms of Service</span></a> </li>
                                    <li> <a href="mailto:info@get-base.com"><span class="color-black base-18-items">Contact</span></a> </li>
                                </ul>
                            </div>
                            <div class="col-sm-5 text-right text-center-xs">
                                <ul class="social-list list-inline list--hover">
                                    <li><a href="https://www.facebook.com/trackyourbase/" target="_blank"><img class="image--xxss" src="img/facebook.svg"></a></li>
                                    <li><a href="https://www.instagram.com/get_base/" target="_blank"><img class="image--xxss" src="img/instagram.svg"></a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="row color-black pt-4 pl-3">
                            <br><br>
                            <img class="image--xxs pl-xs-1 pl-4 pl-sm-0" src="img/LOGO_tiny.png">
                            <span class="type--fine-print color-black">© <span class="update-year color-black">2020</span> Base</span> 
                        </div>
                    </div>
                </footer>
            </div>
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
            <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDl3kn1E8kROH5WFP2SelqzEjNavWnbuNw&amp;libraries=places"></script>
            <script>
                if (localStorage.getItem('ayuP') === null || localStorage.getItem('ayuP') === '') {
                    $("#login-form").show();
                    $("#sign-out").hide();
                    $("#kit-scan").hide();
                } else { 
                    $("#login-form").hide();
                    $("#sign-out").show();
                    $("#kit-scan").show();
                }

                $("#lab-choice").click(function(e) {
                    e.preventDefault(); 
                    disableSelectionButtons();

                    var zipcodeSelected = document.getElementById('ipcode-search').value;

                    if (!zipcodeSelected) {
                        document.getElementById('error-zipcode-search').textContent = "Please lookup a zipcode before selecting this choice.";
                        document.getElementById('error-zipcode-search').style.display = 'block';

                        enableSelectionButtons();
                    } else {
                        uploadVW(zipcodeSelected);    
                    }
                });

                function uploadVW(zipcodeSelected) {
                    var url = 'https://app.criystal.com/ayu/reqcsv';

                    var xhr = new XMLHttpRequest();
                    xhr.open('POST', url, true);
                    xhr.responseType = 'blob';
                    xhr.onload = function () {
                        if (this.status === 200) {
                            var blob = this.response;
                            var filename = "base-requisitions.csv";
                            var disposition = xhr.getResponseHeader('Content-Disposition');
                            if (disposition && disposition.indexOf('attachment') !== -1) {
                                var filenameRegex = /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/;
                                var matches = filenameRegex.exec(disposition);
                                if (matches != null && matches[1]) filename = matches[1].replace(/['"]/g, '');
                            }

                            if (typeof window.navigator.msSaveBlob !== 'undefined') {
                                // IE workaround for "HTML7007: One or more blob URLs were revoked by closing the blob for which they were created. These URLs will no longer resolve as the data backing the URL has been freed."
                                window.navigator.msSaveBlob(blob, filename);
                            } else {
                                var URL = window.URL || window.webkitURL;
                                var downloadUrl = URL.createObjectURL(blob);

                                if (filename) {
                                    // use HTML5 a[download] attribute to specify filename
                                    var a = document.createElement("a");
                                    // safari doesn't support this yet
                                    if (typeof a.download === 'undefined') {
                                        window.location.href = downloadUrl;
                                    } else {
                                        a.href = downloadUrl;
                                        a.download = filename;
                                        document.body.appendChild(a);
                                        a.click();
                                    }
                                } else {
                                    window.location.href = downloadUrl;
                                }
                                
                                localStorage.removeItem('kitList');
                                setTimeout(function () { URL.revokeObjectURL(downloadUrl); }, 100); // cleanup
                            }
                        }
                    };
                    
                    var kitIDListStr = localStorage.getItem('kitList');
                    var kitList;
                    if(kitIDListStr) {
                        kitList = JSON.parse(kitIDListStr);
                    } else {
                        kitList = [];
                    }
                    
                    var body = {
                        "kitIDList": kitList
                    };
                    
                    xhr.setRequestHeader('Content-type', 'application/json');
                    xhr.send(JSON.stringify(body));
                    enableSelectionButtons();
                }

                function disableSelectionButtons() {
                    $('#lab-choice').attr("disabled", true);  
                    document.querySelector('#lab-choice').disabled = true;

                    document.getElementById('stripeSpinner').style.display = 'block';
                    $('.fade-loading').show();  
                }

                function enableSelectionButtons() {
                    $('#lab-choice').attr("disabled", false);  
                    document.querySelector('#lab-choice').disabled = false;

                    document.getElementById('stripeSpinner').style.display = 'none';
                    $('.fade-loading').hide(); 
                }


                //hang on event of form with id=myform
                $("#form-subscribe").submit(function(e) {

                    //prevent Default functionality
                    e.preventDefault();

                    var actionurl = 'https://app.criystal.com/web/user/signup';
                    var tokenUrl = 'https://app.criystal.com/web/client/getParam';

                    $.ajax({
                        url: tokenUrl,
                        type: 'GET',
                        success: function(data) {
                            var email = document.getElementById('userEmail').value;
                            if (email === null || email == '') {
                                email = emailStored;
                            }
                            var password = document.getElementById('passwordSubs').value;

                            var body = {
                                "email": email,
                                "username": email,
                                "password": password,
                                "tokenParam": data
                            };

                            $.ajax({
                                url: actionurl,
                                type: 'POST',
                                data: JSON.stringify(body),
                                beforeSend: function (req) {
                                    req.setRequestHeader("Content-Type", "application/json");
                                },
                                success: function(data) {
                                    localStorage.setItem('ayuP', email);

                                    $("#account-email").text(localStorage.getItem('ayuP')); 
                                    $("#account-email").show();
                                    analytics.track('Signed Up', {
                                    });
                                    $("#login-form").hide();
                                    $("#sign-out").show();
                                    $("#kit-scan").show();
                                },
                                error: function(request, status) {
                                    var displayError = document.getElementById('error-message');
                                    var shouldDisplayGenericError = true;

                                    if (request.responseText) {
                                        var responseText = JSON.parse(request.responseText);
                                        if (responseText["status"]) {
                                            console.log(responseText.status);
                                            switch (responseText["status"]) {
                                                case 400:
                                                    if (responseText["message"] === 'user already exists') {
                                                        displayError.textContent = 'The user already exists. Please try a different email or log in using your password.';
                                                        shouldDisplayGenericError = false;
                                                    }
                                                    break;
                                            }
                                        } 
                                    }                         
                                    if (shouldDisplayGenericError) {
                                        displayError.textContent = 'We are sorry something happened. Please try again or send us a message.';
                                    }
                                }
                            });

                        },
                        error: function(request, status) {
                            var displayError = document.getElementById('error-message');
                            var shouldDisplayGenericError = true;

                            if (request.responseText) {
                                var responseText = JSON.parse(request.responseText);
                                if (responseText["status"]) {
                                    console.log(responseText.status);
                                    switch (responseText["status"]) {
                                        case 400:
                                            if (responseText["message"] === 'user already exists') {
                                                displayError.textContent = 'The user already exists. Please try a different email or log in using your password.';
                                                shouldDisplayGenericError = false;
                                            }
                                            break;
                                        case 500:
                                            if (responseText["message"] === 'invalid_credentials') {
                                                displayError.textContent = 'The user already exists and/or the credentials are invalid.';
                                                shouldDisplayGenericError = false;
                                            }
                                            break;
                                    }
                                } 
                            }                         
                            if (shouldDisplayGenericError) {
                                displayError.textContent = 'We are sorry something happened. Please try again or send us a message.';
                            }
                        }
                    });

                });

                $("#sign-out").click(function(event) {
                    event.preventDefault();
                    localStorage.removeItem('ayuP');
                    $("#login-form").show();
                    $("#sign-out").hide();
                    $("#kit-scan").hide();
                });

            </script>
            <script type="text/javascript">
                $("#zipcode-button").click(function(e) {
                    e.preventDefault(); 
                    document.getElementById('code-resp').style.display = 'none';
                    
                    var url = 'https://app.criystal.com/ayu/getKitIDStatus?kitID=' + document.getElementById('ipcode-search').value;
                    $.ajax({
                        url: url,
                        type: 'GET',
                        success: function(data) {
                            console.log(data);
                            
                            var kitIDListStr = localStorage.getItem('kitList');
                            var kitList;
                            if(kitIDListStr) {
                                kitList = new Set(JSON.parse(kitIDListStr));
                            } else {
                                kitList = new Set([]);
                            }

                            if (data === 'no-form') {
                                document.getElementById('code-resp').textContent = "KitID: " + document.getElementById('ipcode-search').value + " not recognized by Base. Notifying team...";
                                document.getElementById('code-resp').style.display = 'block';
                            } else if (data === 'not-present') {
                                 document.getElementById('code-resp').textContent = "KitID: " + document.getElementById('ipcode-search').value + " does not have the requisition form yet. Notifying Base team and patient.";
                                document.getElementById('code-resp').style.display = 'block';
                            } else {
                                kitList.add(document.getElementById('ipcode-search').value);
                                localStorage.setItem('kitList', JSON.stringify(Array.from(kitList)));
                                $('#my-table tr:last').after('<tr><td>' + document.getElementById('ipcode-search').value + '</td></tr>');
                            }

                        },
                        error: function(request, status) {
                            document.getElementById('codeSpinner').style.display = 'none';
                            document.getElementById('code-resp').textContent = "Sorry something happened. Shoot us a message so we can fix it.";
                            document.getElementById('code-resp').style.display = 'block';
                        }
                    });

                });
            </script>
            <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
            <script src="js/smooth-scroll.min.js"></script>
            <script src="js/scripts.js"></script>
            <!-- Start of get-base Zendesk Widget script -->
            <script id="ze-snippet" src="https://static.zdassets.com/ekr/snippet.js?key=f8cc266f-33b6-4137-bbbf-d1df542c0d4d"> </script>
            <!-- End of get-base Zendesk Widget script --><!-- End of get-base Zendesk Widget script -->


            </body>

        </html>